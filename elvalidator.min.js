var e={d:(r,t)=>{for(var i in t)e.o(t,i)&&!e.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:t[i]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{Mixed:()=>t,default:()=>i});const t=Symbol("Mixed");class i{constructor(e={},r={strictMode:!0,throwUnkownFields:!1,accumulateErrors:!1}){this.schema=this._checkSchema(e),this.options=r,this.errors=[]}_checkSchema(e,r="Schema"){if(!i.isObject(e))throw new Error(r+" must be an object.");for(let s in e){let o=r+"."+s;var a=e[s];if(e[s]={},i.isArray(a))e[s]={type:a};else{if(!i.isObject(a))throw new Error(o+" must be an object.");!i.hasOwnProperty(a,"$or")&&i.hasOwnProperty(a,"type")&&(e[s]={type:a.type})}if(i.hasOwnProperty(a,"$or")){if(!i.isArray(a.$or))throw new Error(o+".$or must be an array.");e[s].$or=a.$or.map(((e,r)=>this._checkSchema({v:e},o+".$or["+r+"]").v))}else{if(!i.hasOwnProperty(e[s],"type")||i.isObject(e[s].type)){e[s]=this._checkSchema(a,o);continue}if(i.isArray(e[s].type)){if(1!=e[s].type.length)throw new Error(o+" must have a single item.");e[s].type=[this._checkSchema({v:e[s].type[0]},o).v],i.hasOwnProperty(a,"minEntries")&&(e[s].minEntries=parseInt(a.minEntries)||0),i.hasOwnProperty(a,"maxEntries")&&(e[s].maxEntries=parseInt(a.maxEntries)||0),i.hasOwnProperty(a,"uniqueValues")&&(e[s].uniqueValues=!!a.uniqueValues),i.hasOwnProperty(e[s].type[0],"required")&&(e[s].required=!!e[s].type[0].required)}else if(e[s].type===String){if(i.hasOwnProperty(a,"maxLength")&&(e[s].maxLength=parseInt(a.maxLength)||0),i.hasOwnProperty(a,"minLength")&&(e[s].minLength=parseInt(a.minLength)||0),i.hasOwnProperty(a,"lowercase")&&(e[s].lowercase=!!a.lowercase),i.hasOwnProperty(a,"uppercase")&&(e[s].uppercase=!!a.uppercase),i.hasOwnProperty(a,"trim")&&(e[s].trim=!!a.trim),i.hasOwnProperty(a,"enum")){if(!i.isArray(a.enum))throw new Error(o+" must have an array value for its enum field.");e[s].enum=a.enum.map((e=>String(e)))}if(i.hasOwnProperty(a,"match")){if(!(a.match instanceof RegExp))throw new Error(o+' has an invalid RegExp for its "match" field.');e[s].match=a.match}}else if(e[s].type===Number)i.hasOwnProperty(a,"min")&&(e[s].min=parseInt(a.min)||0),i.hasOwnProperty(a,"max")&&(e[s].max=parseInt(a.max)||0),i.hasOwnProperty(a,"integer")&&(e[s].integer=!!a.integer);else if(e[s].type===Boolean);else if(e[s].type===Object);else if(e[s].type!==t)throw new Error(o+' has an invalid value for the "type" field.')}if(i.hasOwnProperty(a,"default")&&(e[s].default=a.default),i.hasOwnProperty(a,"required")&&(e[s].required=!!a.required),i.hasOwnProperty(a,"name")&&(e[s].name=String(a.name)),i.hasOwnProperty(a,"validator")){if("function"!=typeof a.validator)throw new Error(o+' must have a function for the "validator" field.');e[s].validator=a.validator}}return e}async validate(e){this.errors=[];var r=await this._validate(e,this.schema,"");if(this.errors.length>0)throw new Error(this.errors.join("\n"));return r}_error(e){if(!this.options.accumulateErrors)throw new Error(e);this.errors.push(e)}async _validateField(e,r,a){var s=r.name||a;if(void 0!==e){switch(r.type){case String:if(!i.isString(e)){if(this.options.strictMode)return void this._error('The "'+s+'" field must be a text value.');e=i.hasOwnProperty(r,"default")&&"number"!=typeof e?r.default:String(e)}r.uppercase&&(e=e.toUpperCase()),r.lowercase&&(e=e.toLowerCase()),r.trim&&(e=e.trim()),i.hasOwnProperty(r,"maxLength")&&e.length>r.maxLength&&(this.options.strictMode?this._error('The "'+s+'" field must be at most '+r.maxLength+" characters long."):e=e.subString(0,r.maxLength)),i.hasOwnProperty(r,"minLength")&&e.length<r.minLength&&this._error('The "'+s+'" field must be at least '+r.minLength+" characters long."),i.hasOwnProperty(r,"enum")&&!r.enum.includes(e)&&this._error('The "'+s+'" field has an invalid value.'),i.hasOwnProperty(r,"match")&&!e.match(r.match)&&this._error('The "'+s+"\" field doesn't match the required format.");break;case Number:if(!i.isNumber(e)){if(this.options.strictMode||!i.hasOwnProperty(r,"default"))return void this._error('The "'+s+'" field must be a number.');e=r.default}i.hasOwnProperty(r,"integer")&&Math.round(e)!=e&&(this.options.strictMode?this._error('The "'+s+'" field must be an integer.'):e=Math.round(e)),i.hasOwnProperty(r,"max")&&e>r.max&&(this.options.strictMode?this._error('The "'+s+'" field must be smaller than "'+r.max+'".'):e=r.max),i.hasOwnProperty(r,"min")&&e<r.min&&(this.options.strictMode?this._error('The "'+s+'" field must be greater than "'+r.min+'".'):e=r.min);break;case Boolean:if(!i.isBoolean(e)){if(this.options.strictMode)return void this._error('The "'+s+'" field must be a boolean value.');e=!!e}break;case Object:if(!i.isObject(e)){if(this.options.strictMode)return void this._error('The "'+s+'" field must be an object.');e={}}break;case t:break;default:if(i.isArray(r.type)){if(!i.isArray(e)){if(this.options.strictMode)return void this._error('The "'+s+'" field must be an array.');e=[]}var o=[];for(let t in e){var n=await this._validate({value:e[t]},{value:r.type[0]},a+"["+t+"]");i.isObject(n)&&i.hasOwnProperty(n,"value")?o.push(n.value):this.options.strictMode&&this._error('The "'+s+'" array has an invalid value at index "'+t+'".')}e=o,i.hasOwnProperty(r,"uniqueValues")&&r.uniqueValues&&(e=e.filter(((r,t)=>e.indexOf(r)===t))),i.hasOwnProperty(r,"maxEntries")&&e.length>r.maxEntries&&(this.options.strictMode?this._error('The "'+s+'" field must have at most "'+r.maxEntries+'" entries.'):e=e.slice(0,r.maxEntries)),i.hasOwnProperty(r,"minEntries")&&e.length<r.minEntries&&this._error('The "'+s+'" field must have at least "'+r.minEntries+'" entries.')}else{if(!i.isObject(e)){if(this.options.strictMode)return void this._error('The "'+s+'" field must be an object.');e={}}e=await this._validate(e,r,a)}}if(i.hasOwnProperty(r,"validator"))try{e=(await Promise.all([r.validator(e)]))[0]}catch(e){return void this._error(String(e))}}else i.hasOwnProperty(r,"default")?e=r.default:i.hasOwnProperty(r,"required")&&r.required&&this._error('The "'+s+'" field is required.');return e}async _validate(e,r,t){if(!i.isObject(e))return this._error('Invalid data field "'+t+'". It must be an Object.');var a={};if(this.options.throwUnkownFields)for(let t in e)i.hasOwnProperty(r,t)||this._error('Field "'+t+'" is not known.');for(let l in r)if(i.hasOwnProperty(r[l],"$or")){var s=e[l],o=void 0;if(void 0!==s){var n=this.errors;for(let e of r[l].$or){this.errors=[],o=void 0;try{if(o=await this._validateField(s,e,t?t+"."+l:l),0==this.errors.length&&void 0!==o)break}catch(e){o=void 0}}this.errors=n}if(void 0===o)if(i.hasOwnProperty(r[l],"default"))o=r[l].default;else if(i.hasOwnProperty(r[l],"required")&&r[l].required){this._error('The "'+(r[l].name||(t?t+"."+l:l))+'" field is required.');continue}void 0!==o&&(a[l]=o)}else{o=e[l],i.hasOwnProperty(r[l],"type")&&!i.isObject(r[l].type)||(o=e[l]||{});var h=await this._validateField(o,r[l],t?t+"."+l:l);void 0!==h&&(a[l]=h)}return a}static get Builtins(){return{Url:{type:String,name:"URL",required:!0,lowercase:!1,trim:!0,match:/^(http|https):\/\/((?!-)[a-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,}(\/.*|$)/i},DomainName:{type:String,name:"Domain name",required:!0,lowercase:!0,trim:!0,match:/^((?!-)[a-z0-9-]{1,63}(?<!-)\.)+[a-z]{2,}$/},Email:{type:String,name:"Email address",required:!0,lowercase:!0,trim:!0,match:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/},YoutubeVideo:{type:String,name:"Youtube Video Url",required:!0,lowercase:!1,trim:!0,match:/^(https?:\/\/)((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/i},VimeoVideo:{type:String,name:"Vimeo Video Url",required:!0,lowercase:!1,trim:!0,match:/^(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/}}}static get Types(){return{String,Number,Boolean,Array,Object,Mixed:t}}static hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}static isObject(e){return e===Object(e)&&"object"==typeof e&&!i.isArray(e)}static isArray(e){return Array.isArray(e)}static isString(e){return"string"==typeof e}static isNumber(e){return"number"==typeof e&&!isNaN(e)}static isBoolean(e){return"boolean"==typeof e}static async validate(e,r,t){var a=new i(r,t);return await a.validate(e)}}module.exports.ElValidator=r;