var e={d:(r,t)=>{for(var i in t)e.o(t,i)&&!e.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:t[i]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{default:()=>t});class t{constructor(e={},r={strictMode:!0,throwUnkownFields:!1,accumulateErrors:!1}){this.schema=this._checkSchema(e),this.options=r,this.errors=[]}_checkSchema(e,r="Schema"){if(!t.isObject(e))throw new Error(r+" must be an object.");for(let a in e){let s=r+"."+a;var i=e[a];if(e[a]={},t.isArray(i))e[a]={type:i};else{if(!t.isObject(i))throw new Error(s+" must be an object.");!t.hasOwnProperty(i,"$or")&&t.hasOwnProperty(i,"type")&&(e[a]={type:i.type})}if(t.hasOwnProperty(i,"$or")){if(!t.isArray(i.$or))throw new Error(s+".$or must be an array.");e[a].$or=i.$or.map(((e,r)=>this._checkSchema({v:e},s+".$or["+r+"]").v))}else{if(!t.hasOwnProperty(e[a],"type")||t.isObject(e[a].type)){e[a]=this._checkSchema(i,s);continue}if(t.isArray(e[a].type)){if(1!=e[a].type.length)throw new Error(s+" must have a single item.");e[a].type=[this._checkSchema({v:e[a].type[0]},s).v],t.hasOwnProperty(i,"minEntries")&&(e[a].minEntries=parseInt(i.minEntries)||0),t.hasOwnProperty(i,"maxEntries")&&(e[a].maxEntries=parseInt(i.maxEntries)||0),t.hasOwnProperty(i,"uniqueValues")&&(e[a].uniqueValues=!!i.uniqueValues),t.hasOwnProperty(e[a].type[0],"required")&&(e[a].required=!!e[a].type[0].required)}else if(e[a].type===String){if(t.hasOwnProperty(i,"maxlength")&&(e[a].maxlength=parseInt(i.maxlength)||0),t.hasOwnProperty(i,"maxlength")&&(e[a].maxlength=parseInt(i.maxlength)||0),t.hasOwnProperty(i,"lowercase")&&(e[a].lowercase=!!i.lowercase),t.hasOwnProperty(i,"uppercase")&&(e[a].uppercase=!!i.uppercase),t.hasOwnProperty(i,"trim")&&(e[a].trim=!!i.trim),t.hasOwnProperty(i,"enum")){if(!t.isArray(i.enum))throw new Error(s+" must have an array value for its enum field.");e[a].enum=i.enum.map((e=>String(e)))}if(t.hasOwnProperty(i,"match")){if(!(i.match instanceof RegExp))throw new Error(s+' has an invalid RegExp for its "match" field.');e[a].match=i.match}}else if(e[a].type===Number)t.hasOwnProperty(i,"min")&&(e[a].min=parseInt(i.min)||0),t.hasOwnProperty(i,"max")&&(e[a].max=parseInt(i.max)||0),t.hasOwnProperty(i,"integer")&&(e[a].integer=!!i.integer);else if(e[a].type===Boolean);else if(e[a].type!==Object)throw new Error(s+' has an invalid value for the "type" field.')}if(t.hasOwnProperty(i,"default")&&(e[a].default=i.default),t.hasOwnProperty(i,"required")&&(e[a].required=!!i.required),t.hasOwnProperty(i,"name")&&(e[a].name=String(i.name)),t.hasOwnProperty(i,"validator")){if("function"!=typeof i.validator)throw new Error(s+' must have a function for the "validator" field.');e[a].validator=i.validator}}return e}async validate(e){this.errors=[];var r=await this._validate(e,this.schema,"");if(this.errors.length>0)throw new Error(this.errors.join("\n"));return r}_error(e){if(!this.options.accumulateErrors)throw new Error(e);this.errors.push(e)}async _validateField(e,r,i){var a=r.name||i;if(void 0!==e){switch(r.type){case String:if(!t.isString(e)){if(this.options.strictMode)return void this._error('The "'+a+'" field must be a text value.');e=t.hasOwnProperty(r,"default")&&"number"!=typeof e?r.default:String(e)}r.uppercase&&(e=e.toUpperCase()),r.lowercase&&(e=e.toLowerCase()),r.trim&&(e=e.trim()),t.hasOwnProperty(r,"maxlength")&&e.length>r.maxlength&&(this.options.strictMode?this._error('The "'+a+'" field must be at most '+r.maxlength+" characters long."):e=e.subString(0,r.maxlength)),t.hasOwnProperty(r,"minlength")&&e.length>r.minlength&&this._error('The "'+a+'" field must be at least '+r.minlength+" characters long."),t.hasOwnProperty(r,"enum")&&!r.enum.includes(e)&&this._error('The "'+a+'" field has an invalid value.'),t.hasOwnProperty(r,"match")&&!e.match(r.match)&&this._error('The "'+a+"\" field doesn't match the required format.");break;case Number:if(!t.isNumber(e)){if(this.options.strictMode||!t.hasOwnProperty(r,"default"))return void this._error('The "'+a+'" field must be a number.');e=r.default}t.hasOwnProperty(r,"integer")&&Math.round(e)!=e&&(this.options.strictMode?this._error('The "'+a+'" field must be an integer.'):e=Math.round(e)),t.hasOwnProperty(r,"max")&&e>r.max&&(this.options.strictMode?this._error('The "'+a+'" field must be smaller than "'+r.max+'".'):e=r.max),t.hasOwnProperty(r,"min")&&e<r.min&&(this.options.strictMode?this._error('The "'+a+'" field must be greater than "'+r.min+'".'):e=r.min);break;case Boolean:if(!t.isBoolean(e)){if(this.options.strictMode)return void this._error('The "'+a+'" field must be a boolean value.');e=!!e}break;case Object:if(!t.isObject(e)){if(this.options.strictMode)return void this._error('The "'+a+'" field must be an object.');e={}}break;default:if(t.isArray(r.type)){if(!t.isArray(e)){if(this.options.strictMode)return void this._error('The "'+a+'" field must be an array.');e=[]}var s=[];for(let n in e){var o=await this._validate({value:e[n]},{value:r.type[0]},i+"["+n+"]");t.isObject(o)&&t.hasOwnProperty(o,"value")?s.push(o.value):this.options.strictMode&&this._error('The "'+a+'" array has an invalid value at index "'+n+'".')}e=s,t.hasOwnProperty(r,"uniqueValues")&&r.uniqueValues&&(e=e.filter(((r,t)=>e.indexOf(r)===t))),t.hasOwnProperty(r,"maxEntries")&&e.length>r.maxEntries&&(this.options.strictMode?this._error('The "'+a+'" field must have at most "'+r.maxEntries+'" entries.'):e=e.slice(0,r.maxEntries)),t.hasOwnProperty(r,"minEntries")&&e.length<r.minEntries&&this._error('The "'+a+'" field must have at least "'+r.minEntries+'" entries.')}else{if(!t.isObject(e)){if(this.options.strictMode)return void this._error('The "'+a+'" field must be an object.');e={}}e=await this._validate(e,r,i)}}if(t.hasOwnProperty(r,"validator"))try{e=(await Promise.all([r.validator(e)]))[0]}catch(e){return void this._error(String(e))}}else t.hasOwnProperty(r,"default")?e=r.default:t.hasOwnProperty(r,"required")&&r.required&&this._error('The "'+a+'" field is required.');return e}async _validate(e,r,i){if(!t.isObject(e))return this._error('Invalid data field "'+i+'". It must be an Object.');var a={};if(this.options.throwUnkownFields)for(let i in e)t.hasOwnProperty(r,i)||this._error('Field "'+i+'" is not known.');for(let l in r)if(t.hasOwnProperty(r[l],"$or")){var s=e[l],o=void 0;if(void 0!==s){var n=this.errors;for(let e of r[l].$or){this.errors=[],o=void 0;try{if(o=await this._validateField(s,e,i?i+"."+l:l),0==this.errors.length&&void 0!==o)break}catch(e){o=void 0}}this.errors=n}if(void 0===o)if(t.hasOwnProperty(r[l],"default"))o=r[l].default;else if(t.hasOwnProperty(r[l],"required")&&r[l].required){this._error('The "'+(r[l].name||(i?i+"."+l:l))+'" field is required.');continue}void 0!==o&&(a[l]=o)}else{o=e[l],t.hasOwnProperty(r[l],"type")&&!t.isObject(r[l].type)||(o=e[l]||{});var h=await this._validateField(o,r[l],i?i+"."+l:l);void 0!==h&&(a[l]=h)}return a}static get Builtins(){return{Url:{type:String,name:"URL",required:!0,lowercase:!1,trim:!0,match:/^(http|https):\/\/((?!-)[a-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,}(\/.*|$)/i},DomainName:{type:String,name:"Domain name",required:!0,lowercase:!0,trim:!0,match:/^((?!-)[a-z0-9-]{1,63}(?<!-)\.)+[a-z]{2,}$/},Email:{type:String,name:"Email address",required:!0,lowercase:!0,trim:!0,match:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/},YoutubeVideo:{type:String,name:"Youtube Video Url",required:!0,lowercase:!1,trim:!0,match:/^(https?:\/\/)((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/i},VimeoVideo:{type:String,name:"Vimeo Video Url",required:!0,lowercase:!1,trim:!0,match:/^(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/}}}static hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}static isObject(e){return e===Object(e)&&"object"==typeof e&&!t.isArray(e)}static isArray(e){return Array.isArray(e)}static isString(e){return"string"==typeof e}static isNumber(e){return"number"==typeof e&&!isNaN(e)}static isBoolean(e){return"boolean"==typeof e}static async validate(e,r,i){var a=new t(r,i);return await a.validate(e)}}module.exports.ElValidator=r;